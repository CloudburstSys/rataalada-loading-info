<!DOCTYPE html>
<html>
  <head>
    <title><?> ZIP</title>
    <style>
      body {
        background: black;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
      }

      .terminal:before {
        content: "";
        position: absolute;
        height: 100%;
        width: 100%;
        opacity: 0.08;
        left: 0;
        top: 0;
        background: url("https://www.rataalada.com/terminal/grain.gif");
      }

      @media (min-width: 768px) {
        @media (orientation: landscape) {
          .lines {
            padding-bottom: 70vh;
          }
        }
      }

      @media (min-width: 1024px) {
        @media (hover: hover) and (pointer: fine) {
          .lines {
            padding-bottom: 5rem;
          }
        }
      }

      @media (-ms-high-contrast: active), (-ms-high-contrast: none) {
        .lines {
          max-height: 95vh;
        }
      }

      .lines {
        position: fixed;
        max-height: 100vh;
        width: 100vw;
        overflow-y: auto;
        padding-bottom: 50vh;
      }

      .line {
        display: flex;
        color: #25ff00;
        text-shadow: 0 0 2px rgba(37 255 0, 0.7);
        letter-spacing: 0.06em;
        white-space: pre-wrap;
        font-size: 1em;
        font-family: Source Code Pro, monospace;
        font-style: normal;
        font-weight: 400;
        line-height: 1.5rem;
        text-transform: uppercase;
      }
    </style>
  </head>
  <body>
    <div class="terminal">
      <div class="lines">
      </div>
    </div>
    <script type="text/javascript">
      var percentageUpdateInterval = null;
      var untilUpdateInterval = null;

      function blankLine() {
        let template = "<div class='line'>&nbsp;&nbsp;&nbsp;</div>";

        document.getElementsByClassName("lines")[0].innerHTML = document.getElementsByClassName("lines")[0].innerHTML + template;
      }

      function writeLine(text, delay = 25, id, callback = () => {}) {
        let template = "<div class='line' id='activewrite'></div>";
        text = text.split("");

        let written = "";

        document.getElementsByClassName("lines")[0].innerHTML =
        document.getElementsByClassName("lines")[0].innerHTML + template;

        return new Promise((res, rej) => {
          let i = 0;
          let me = setInterval(() => {
            if (i == text.length) {
              document.getElementById("activewrite").id = id;
              clearInterval(me);
              callback();
              res();
            } else {
              document.getElementById("activewrite").innerHTML = written + text[i];
              written = written + text[i];
              i = i + 1;
            }
          }, delay);
        });
      }

      function writeLinkLine(text, href, delay = 25) {
        let template = "<div class='line' id='activewrite'><a href=\""+href+"\"></a></div>";
        text = text.split("");

        let written = "";

        document.getElementsByClassName("lines")[0].innerHTML =
        document.getElementsByClassName("lines")[0].innerHTML + template;

        return new Promise((res, rej) => {
          let i = 0;
          let me = setInterval(() => {
            if (i == text.length) {
              clearInterval(me);
              res();
            } else {
              document.getElementById("activewrite").getElementsByTagName("a")[0].innerHTML = written + text[i];
              written = written + text[i];
              i = i + 1;
            }
          }, delay);
        });
      }

      function sleep(delay) {
        return new Promise((res, rej) => {
          setTimeout(res, delay);
        });
      }
        
      setTimeout(async () => {
        await writeLine(
          ">> scp -i ~/id_extrainfo upstanding-citizen@rataalada.com:/var/www/opo/know_what_i_know.zip /var/www/know_what_i_know.zip",
          100
        );

        await sleep(1000);
        blankLine();
        await sleep(100);
        await writeLine(
          "know_what_i_know.zip                                                                  100%   20MB   20MB/s   00:00",
          25
        );
        await sleep(100);
        await writeLinkLine(
          "[CLICK FOR CASE FILE]",
          "https://rataalada.conep.one/know_what_i_know.zip"
        });
      });
    </script>
  </body>
</html>
